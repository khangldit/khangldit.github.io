"use strict";(self.webpackChunktanca_docs=self.webpackChunktanca_docs||[]).push([[4634],{3905:(t,e,n)=>{n.d(e,{Zo:()=>m,kt:()=>d});var a=n(7294);function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e){if(null==t)return{};var n,a,l=function(t,e){if(null==t)return{};var n,a,l={},r=Object.keys(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||(l[n]=t[n]);return l}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(l[n]=t[n])}return l}var p=a.createContext({}),h=function(t){var e=a.useContext(p),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},m=function(t){var e=h(t.components);return a.createElement(p.Provider,{value:e},t.children)},c="mdxType",s={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},u=a.forwardRef((function(t,e){var n=t.components,l=t.mdxType,r=t.originalType,p=t.parentName,m=o(t,["components","mdxType","originalType","parentName"]),c=h(n),u=l,d=c["".concat(p,".").concat(u)]||c[u]||s[u]||r;return n?a.createElement(d,i(i({ref:e},m),{},{components:n})):a.createElement(d,i({ref:e},m))}));function d(t,e){var n=arguments,l=e&&e.mdxType;if("string"==typeof t||l){var r=n.length,i=new Array(r);i[0]=u;var o={};for(var p in e)hasOwnProperty.call(e,p)&&(o[p]=e[p]);o.originalType=t,o[c]="string"==typeof t?t:l,i[1]=o;for(var h=2;h<r;h++)i[h]=n[h];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},1606:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>p,contentTitle:()=>i,default:()=>s,frontMatter:()=>r,metadata:()=>o,toc:()=>h});var a=n(7462),l=(n(7294),n(3905));const r={sidebar_position:4},i="Import/Export Excel",o={unversionedId:"front-end/web-admin/import-export-excel",id:"front-end/web-admin/import-export-excel",title:"Import/Export Excel",description:"Trong vi\u1ec7c qu\u1ea3n l\xed th\xf4ng tin ta s\u1ebd ti\u1ebfp x\xfac v\u1edbi r\u1ea5t nhi\u1ec1u danh s\xe1ch d\u1eef li\u1ec7u nh\u01b0 Nh\xe2n vi\xean, Ca l\xe0m, Ph\xf2ng ban, Chi nh\xe1nh,... Khi d\u1eef li\u1ec7u \u0111\u1ea1t s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ee7 nhi\u1ec1u th\xec vi\u1ec7c x\u1eed l\xfd t\u1eebng d\u1eef li\u1ec7u m\u1ed9t r\u1ea5t kh\xf3 tr\xe1nh kh\u1ecfi vi\u1ec7c sai x\xf3t n\xean nhu c\u1ea7u v\u1ec1 x\u1eed l\xfd d\u1eef li\u1ec7u h\xe0ng lo\u1ea1t \u0111\u01b0\u1ee3c sinh ra \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\xe0y.",source:"@site/docs/front-end/web-admin/import-export-excel.md",sourceDirName:"front-end/web-admin",slug:"/front-end/web-admin/import-export-excel",permalink:"/docs/front-end/web-admin/import-export-excel",draft:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Component Creation",permalink:"/docs/front-end/web-admin/conponent-generation"},next:{title:"Structuring (NO content)",permalink:"/docs/front-end/web-admin/structuring"}},p={},h=[{value:"Export",id:"export",level:2},{value:"Name the file (\u0110\u1eb7t t\xean)",id:"name-the-file-\u0111\u1eb7t-t\xean",level:3},{value:"ModalExportExcelWithTable",id:"modalexportexcelwithtable",level:4},{value:"AdvanceModalExportExcel",id:"advancemodalexportexcel",level:4},{value:"Export for view (Xem)",id:"export-for-view-xem",level:3},{value:"Export for import (Th\xeam, S\u1eeda)",id:"export-for-import-th\xeam-s\u1eeda",level:3},{value:"Implementation (Tri\u1ec3n khai)",id:"implementation-tri\u1ec3n-khai",level:3},{value:"Import",id:"import",level:2}],m={toc:h},c="wrapper";function s(t){let{components:e,...r}=t;return(0,l.kt)(c,(0,a.Z)({},m,r,{components:e,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"importexport-excel"},"Import/Export Excel"),(0,l.kt)("p",null,"Trong vi\u1ec7c qu\u1ea3n l\xed th\xf4ng tin ta s\u1ebd ti\u1ebfp x\xfac v\u1edbi r\u1ea5t nhi\u1ec1u danh s\xe1ch d\u1eef li\u1ec7u nh\u01b0 Nh\xe2n vi\xean, Ca l\xe0m, Ph\xf2ng ban, Chi nh\xe1nh,... Khi d\u1eef li\u1ec7u \u0111\u1ea1t s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ee7 nhi\u1ec1u th\xec vi\u1ec7c x\u1eed l\xfd t\u1eebng d\u1eef li\u1ec7u m\u1ed9t r\u1ea5t kh\xf3 tr\xe1nh kh\u1ecfi vi\u1ec7c sai x\xf3t n\xean nhu c\u1ea7u v\u1ec1 x\u1eed l\xfd d\u1eef li\u1ec7u h\xe0ng lo\u1ea1t \u0111\u01b0\u1ee3c sinh ra \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\xe0y."),(0,l.kt)("p",null,"Export/Import c\xf3 c\xe1c t\xednh n\u0103ng n\u1ed5i b\u1eadt:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Xu\u1ea5t s\u1ed1 l\u01b0\u1ee3ng l\u1edbn d\u1eef li\u1ec7u ra file Excel")," - cho ph\xe9p xem t\u1ed5ng quan ho\u1eb7c x\u1eed l\xfd x\u1eed d\u1ee5ng \u1edf nhi\u1ec1u m\u1ee5c \u0111\xedch kh\xe1c t\u1eeb file Excel."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Nh\u1eadp h\xe0ng lo\u1ea1t th\xf4ng tin m\u1edbi")," - cho ph\xe9p t\u1ea1o h\xe0ng lo\u1ea1t d\u1eef li\u1ec7u c\xf9ng l\xfac tr\xe1nh c\xe1c l\u1ed7i nh\u1eadp li\u1ec7u khi x\u1eed l\xfd t\u1eebng d\u1eef li\u1ec7u."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"C\u1eadp nh\u1eadt h\xe0ng lo\u1ea1th")," - cho ph\xe9p ch\u1ec9nh s\u1eeda v\xe0 c\u1eadp nh\u1eadt nhi\u1ec1u d\u1eef li\u1ec7u m\u1ed9t c\xe1ch nhanh ch\xf3ng")),(0,l.kt)("h2",{id:"export"},"Export"),(0,l.kt)("h3",{id:"name-the-file-\u0111\u1eb7t-t\xean"},"Name the file (\u0110\u1eb7t t\xean)"),(0,l.kt)("p",null,"M\u1ed7i m\u1ed9t file excel xu\u1ea5t ra ph\u1ea3i \u0111\u1ea3m b\u1ea3o t\xean file \u0111\u01b0\u1ee3c \u0111\u1eb7t \u0111\xfang quy t\u1eaft sau:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"View (ch\u1ec9 xem)")," - T\xean ph\u1ea3i l\xe0 danh t\u1eeb th\u1ec3 hi\u1ec7n r\xf5 trong file ch\u1ee9 n\u1ed9i dung g\xec v\xe0 kh\xf4ng \u0111\u01b0\u1ee3c tr\xf9ng v\u1edbi b\u1ea5t k\xec file xu\u1ea5t ra \u1edf ch\u1ed7 kh\xe1c. V\xed d\u1ee5:")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"// vi\nBang_Ngay_Cong_Theo_Du_An.xlsx\nBang_Gio_Cong_Theo_Chi_Nhanh.xlsx\nDanh_Sach_Cong_Viec_Trong_Du_An.xlsx\n// en\nSalary_n_Allowance_List.xlsx\nTimekeeping_Shifts_By_Hour_Vertical.xlsx\nTimekeeping_Shifts_By_Day_Vertical.xlsx\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Create, Update (T\u1ea1o v\xe0 S\u1eeda)"),' - trong t\xean ph\u1ea3i c\xf3 c\xf3 t\u1eeb "M\u1eabu" (template) \u0111\u1ec3 th\u1ec3 hi\u1ec7n n\xf3 l\xe0 file d\xf9ng \u0111\u1ec3 import, b\xean c\u1ea1nh c\u0169ng th\u1ec3 hi\u1ec7n \u0111\u01b0\u1ee3c h\xe0nh \u0111\u1ed9ng c\u1ee7a file s\u1ebd l\xe0m g\xec. V\xed du:')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"Mau_Cap_Nhat_Tien_Luong_Tro_Cap.xlsx\nMau_Cap_Nhat_Phan_Quyen_Theo_Nhan_Vien.xlsx\nMau_Cap_Nhat_Phan_Quyen_Theo_Nhom_Quan_Ly.xlsx\n// en\nImport_Shift_Template.xlsx\nImport_Update_Shift_Template.xlsx\nImport_Dayoff_Template_By_Total.xlsx\n")),(0,l.kt)("h4",{id:"modalexportexcelwithtable"},"ModalExportExcelWithTable"),(0,l.kt)("p",null,"\u0110\xe2y l\xe0 1 b\u1ed9 Export \u0111\u01b0\u1ee3c \u0111\u01b0\u1ee3c c\u1ea5u h\xecnh s\u1eb5n, ch\u1ec9 c\u1ea7n extends v\xe0 custom l\u1ea1i c\xe1c h\xe0m c\u1ea7n thi\u1ebft"),(0,l.kt)("p",null,"Flow Export ModalExportExcelWithTable g\u1ea7n 4 giai \u0111o\u1ea1n:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"Setup"),': Set up th\xf4ng tin header, api, column ngay t\xf9 \u0111\u1ea7u sau \u0111\xf3 g\u1ecdi "Start"'),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"Request data"),": L\u1ea5y d\u1eef li\u1ec7u t\u1eeb api v\u1ec1 v\xe0 x\u1eed l\xfd hi\u1ec3n th\u1ecb ph\u1ea7n tr\u0103m"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"Create table"),": D\u1eef li\u1ec7u \u0111\u01b0\u1ee3c x\u1eed l\xed v\xe0 t\u1ea1o ra m\u1ed9t html table \u1ea9n trong trang hi\u1ec7n t\u1ea1i"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"Download"),": T\u1eeb table \u0111\xe3 t\u1ea1o ra \u0111\xf3ng g\xf3i v\xe0o file excel v\xe0 t\u1ea3i v\u1ec1")),(0,l.kt)("p",null,"Flow (theo c\xe1c keyword ch\xednh):"),(0,l.kt)("p",null,"(1) ",(0,l.kt)("strong",{parentName:"p"},"Start")," => ",(0,l.kt)("strong",{parentName:"p"},"onBeforeStart")),(0,l.kt)("p",null,"(2) ",(0,l.kt)("strong",{parentName:"p"},"requestData")," => ",(0,l.kt)("strong",{parentName:"p"},"processData")," => ",(0,l.kt)("strong",{parentName:"p"},"processItem")," => ",(0,l.kt)("strong",{parentName:"p"},"processDone")," (quay l\u1ea1i ",(0,l.kt)("strong",{parentName:"p"},"processData")," n\u1ebfu v\u1eabn c\xf2n d\u1eef li\u1ec7u) => ",(0,l.kt)("strong",{parentName:"p"},"createTableHtml")),(0,l.kt)("p",null,"(3) ",(0,l.kt)("strong",{parentName:"p"},"buildHeader")," => ",(0,l.kt)("strong",{parentName:"p"},"buildDataRows")," => ",(0,l.kt)("strong",{parentName:"p"},"createElement")," => ",(0,l.kt)("strong",{parentName:"p"},"appendChild")),(0,l.kt)("p",null,"(4) ",(0,l.kt)("strong",{parentName:"p"},"tableToSheet")," => ",(0,l.kt)("strong",{parentName:"p"},"Save")),(0,l.kt)("p",null,"M\u1ed9t s\u1ed1 keyword, function quan tr\u1ecdng:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"onBeforeStart"),": R\u1ea5t quan tr\u1ecdng, cho ph\xe9p setup headers (this.headers) v\xe0 data Indexes \u0111\u1ea3m b\u1ea3o hi\u1ec3n th\u1ecb \u0111\xfang v\xe0 \u0111\u1eb9p")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"requestData"),": B\u1eaft \u0111\u1ea7u get data v\u1ec1")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"processData"),": X\u1eed l\xed d\u1eef li\xeau nh\u1eadn v\u1ec1 hi\u1ec3n th\u1ecb ph\u1ea7n tr\u0103m")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"processItem"),": Nh\u1eadn 1 item trong array get \u0111\u01b0\u1ee3c v\xe0 transform th\xe0nh m\u1ed9t data m\u1edbi ph\xf9 h\u1ee3p v\u1edbi dataIndexes, n\u1ebfu ch\u01b0a l\u1ea5y \u0111\u1ee7 h\u1ebft data s\u1ebd quay l\u1ea1i ",(0,l.kt)("strong",{parentName:"p"},"requestData"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"processDone"),": Sau khi \u0111\u1ee7 d\u1eef li\u1ec7u ti\u1ebfn h\xe0nh \u0111\xf3ng g\xf3i th\xe0nh table"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"tableHTMLRows"),": T\u1ea1o ra 1 table html d\u01b0\u1edbi d\u1ea1ng string"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"buildHeader"),": Build ra header c\u1ee7a table ",(0,l.kt)("inlineCode",{parentName:"li"},"th")," v\xe0 ch\xe8n v\xe0o table"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"buildDataRows"),": Build c\xe1c d\u1eef li\u1ec7u \u1ee9ng v\u1edbi header ",(0,l.kt)("inlineCode",{parentName:"li"},"td")," v\xe0 ch\xe8n v\xe0o table"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"createElement"),": T\u1ea1o ra 1 ",(0,l.kt)("inlineCode",{parentName:"li"},"<div/>")," v\xe0 ch\xe8n table v\u1eeba sinh ra \u1edf tr\xean v\xe0o"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"appendChild"),": Cu\u1ed1i c\xf9ng g\u1eafn v\xe0o trong app d\u01b0\u1edbi d\u1ea1ng \u1ea9n ",(0,l.kt)("inlineCode",{parentName:"li"},"'display:none;'")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"tableToSheet"),": Khi user b\u1ea5m Download th\xec s\u1ebd th\u1ef1c hi\u1ec7n convert table html b\xean tr\xean th\xe0nh sheet trong file xlsx")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Save"),": v\xe0 t\u1ef1 \u0111\u1ed9ng t\u1ea3i xu\u1ed1ng"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="Convert string table to html element"',title:'"Convert',string:!0,table:!0,to:!0,html:!0,'element"':!0},'const tableContaner = document.createElement("div");\ntableContaner.id = "forTableToExcel";\ntableContaner.innerHTML = tableHTMLRows;\ntableContaner.style = "display:none;";\ndocument.body.appendChild(tableContaner);\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="Convert table to xlsx file and download"',title:'"Convert',table:!0,to:!0,xlsx:!0,file:!0,and:!0,'download"':!0},"download(filename) {\n    try {\n      const tableSheet1 = document.getElementById('export_table');\n      const tableSheet1Opts = {\n        autoStyle: false,\n        sheet: {\n          name: 'Sheet 1',\n        },\n      };\n\n      let wb = TableToExcel.initWorkBook();\n      wb = TableToExcel.tableToSheet(wb, tableSheet1, tableSheet1Opts);\n\n      TableToExcel.save(wb, filename || 'export.xlsx');\n    } catch (e) {\n      // Todo\n    }\n  }\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"this.url"),": api url \u0111\u1ec3 g\u1ecdi l\u1ea5y d\u1eef li\u1ec7u"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"this.params"),": params \u0111i chung v\u1edbi this.url"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"this.headers"),": b\xean trong ",(0,l.kt)("strong",{parentName:"li"},"onBeforeStart")," s\u1ebd push c\xe1c header v\xe0o t\u1eeb b\xean tr\xe1i qua (c\xf3 th\u1ec3 custom m\xe0u, font-size, rowspan,...)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"this.dataIndexes"),": \u1ee9ng v\u1edbi 1 ",(0,l.kt)("strong",{parentName:"li"},"Headers")," s\u1ebd c\xf3 1 ",(0,l.kt)("strong",{parentName:"li"},"Indexes"),", c\xf3 field ",(0,l.kt)("strong",{parentName:"li"},"index")," (string), m\u1eb7c \u0111\u1ecbnh s\u1ebd \u0111\u1ecdc field \u0111\xf3 c\u1ee7a d\u1eef li\u1ec7u v\xe0 show l\xean, tr\u01b0\u1eddng h\u1ee3p field \u0111\xf3 kh\xf4ng ph\u1ea3i l\xe0 string th\xec d\xf9ng ",(0,l.kt)("strong",{parentName:"li"},"renderCell")," v\xe0 ph\u1ea3i return v\u1ec1 1 json")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'renderCell: (item, dateIndex) => {\n  const value = item.name;\n  const dataType = \'data-t="s"\';\n  const fontSize = `data-f-sz="9"`;\n  return {\n    value,\n    html: `\n      <td ${dataType}  ${fontSize} data-fill-color="8DB4E2" data-a-h="s">${value}</td>\n    `,\n  };\n};\n')),(0,l.kt)("admonition",{title:"L\u01b0u \xfd",type:"caution"},(0,l.kt)("p",{parentName:"admonition"},"Length c\u1ee7a ",(0,l.kt)("strong",{parentName:"p"},"headers")," v\xe0 ",(0,l.kt)("strong",{parentName:"p"},"indexes")," ph\u1ea3i b\u1eb1ng nhau \u0111\u1ec3 m\u1ed7i row render ra kh\xf4ng b\u1ecb l\u1ec7nh\nTr\u1eeb m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p s\u1eed d\u1ee5ng colspan ph\u1ea3i t\xednh to\xe1n ch\xednh x\xe1c")),(0,l.kt)("h4",{id:"advancemodalexportexcel"},"AdvanceModalExportExcel"),(0,l.kt)("p",null,"C\u0169ng l\xe0 m\u1ed9t module d\xf9ng \u0111\u1ec3 xu\u1ea5t excel \u0111\u01b0\u1ee3c extends t\u1eeb ",(0,l.kt)("strong",{parentName:"p"},"ModalExportExcelWithTable")," nh\u01b0ng c\xf3 nhi\u1ec1u ph\u1ea7n c\u1ea3i ti\u1ebfn v\xe0 d\u1ec5 s\u1eed d\u1ee5ng h\u01a1n. Tham kh\u1ea3o th\xeam t\u1ea1i\n",(0,l.kt)("inlineCode",{parentName:"p"},"app/components/ui/ModalExportExcel/AdvanceModalExportExcel.js")),(0,l.kt)("h3",{id:"export-for-view-xem"},"Export for view (Xem)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Xu\u1ea5t th\xf4ng tin ra file excel \u0111\u1ec3 xem ho\u1eb7c s\u1eed d\u1ee5ng v\u1edbi m\u1ee5c \u0111\xedch kh\xe1c \u1edf 1 n\u01a1i kh\xe1c"),(0,l.kt)("li",{parentName:"ul"},"Kh\xf4ng c\xf3 gi\xe1 tr\xed import l\u1ea1i v\xe0o Tanca")),(0,l.kt)("h3",{id:"export-for-import-th\xeam-s\u1eeda"},"Export for import (Th\xeam, S\u1eeda)"),(0,l.kt)("p",null,"Th\u01b0\u1eddng s\u1ebd d\xf9ng \u0111\u1ec3 export ra 1 file excel v\xe0 ch\u1ec9nh s\u1eeda th\xf4ng tin trong file v\xe0 import tr\u1edf l\u1ea1i \u0111\u1ec3 x\u1eed l\xed d\u1eef li\u1ec7u (Th\xeam m\u1edbi v\xe0 C\u1eadp nh\u1eadt)."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"T\u1ea5t c\u1ea3")," file xu\u1ea5t ra ",(0,l.kt)("strong",{parentName:"p"},"ph\u1ea3i c\xf3")," 1 sheet ",(0,l.kt)("strong",{parentName:"p"},"Th\xf4ng tin")," ch\u1ee9a th\xf4ng tin ",(0,l.kt)("strong",{parentName:"p"},"\u0111\u1ec3")," qu\xe1 tr\xecnh ",(0,l.kt)("strong",{parentName:"p"},"Import")," c\xf3 th\u1ec3 x\u1eed l\xed \u0111\u01b0\u1ee3c. Th\xf4ng tin bao g\u1ed3m:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Th\xf4ng tin"),": Th\u1ec3 hi\u1ec7n \u0111\u01b0\u1ee3c file \u0111ang d\xf9ng \u0111\u1ec3 l\xe0m g\xec"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"T\u1eeb kh\xf3a"),": T\u1eeb kh\xf3a c\u1ee7a file, kh\xf4ng tr\xf9ng v\u1edbi c\xe1c h\xe0nh \u0111\u1ed9ng kh\xe1c"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Phi\xean b\u1ea3n"),": D\xf9ng \u0111\u1ec3 ph\xe2n bi\u1ec7t khi c\xf3 c\u1eadp nh\u1eadt th\xec kh\xf4ng d\xf9ng \u0111\u01b0\u1ee3c file c\u0169 n\u1eefa"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u0110\u1ed1i v\u1edbi file d\xf9ng \u0111\u1ec3 ",(0,l.kt)("strong",{parentName:"p"},"Th\xeam m\u1edbi"),": File xu\u1ea5t ra ph\u1ea3i c\xf3 s\u1eb5n header, th\u1ec3 hi\u1ec7n \u0111\u01b0\u1ee3c c\u1ed9t n\xe0o b\u1eaft bu\u1ed9c, c\u1ed9t n\xe0o kh\xf4ng b\u1eaft bu\u1ed9c")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u0110\u1ed1i v\u1edbi file d\xf9ng \u0111\u1ec3 ",(0,l.kt)("strong",{parentName:"p"},"C\u1eadp nh\u1eadt"),": File xu\u1ea5t ra ph\u1ea3i c\xf3 m\u1ed9t c\u1ed9t ch\u1ee9 th\xf4ng tin \u0111\u1ecbnh danh (id, user_id, identification,...) h\u1ed7 tr\u1ee3 vi\u1ec7c import \u0111\u1ecbnh danh \u0111\u01b0\u1ee3c v\xe0 c\u1eadp nh\u1eadt")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Th\u01b0\u1eddng s\u1ebd s\u1eed d\u1ee5ng ",(0,l.kt)("strong",{parentName:"p"},"AdvanceModalExportExcel")," \u0111\u1ec3 xu\u1ea5t file v\xe0 s\u1eed d\u1ee5ng h\xe0m ",(0,l.kt)("strong",{parentName:"p"},"createTableHtml")," \u0111\u1ec3 t\u1ea1o ra b\u1ea3ng th\xf4ng tin v\xe0 ch\xe8n v\xe0o \u1edf ",(0,l.kt)("inlineCode",{parentName:"p"},"download()"),". (search ",(0,l.kt)("inlineCode",{parentName:"p"},"createTableHtml")," \u0111\u1ec3 tham kh\u1ea3o)"))),(0,l.kt)("h3",{id:"implementation-tri\u1ec3n-khai"},"Implementation (Tri\u1ec3n khai)"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"X\xe1c \u0111\u1ecbnh file c\u1ea7n xu\u1ea5t ra s\u1ebd nh\u01b0 n\xe0o"),(0,l.kt)("li",{parentName:"ol"},"Xem tr\xean website xem ch\u1ed7 n\xe0o xu\u1ea5t ra file g\u1ea7n gi\u1ed1ng c\u1ea5u tr\xfac c\u1ee7a file c\u1ea7n l\xe0m"),(0,l.kt)("li",{parentName:"ol"},"T\u1eeb t\xean file tham kh\u1ea3o t\xecm ra file .js"),(0,l.kt)("li",{parentName:"ol"},"Clone file ra m\u1ed9t file kh\xe1c v\xe0 \u0111\u1eb7t \u0111\xfang v\u1ecb tr\xed m\u1edbi"),(0,l.kt)("li",{parentName:"ol"},"\u0110\u1ecdc code, hi\u1ec3u v\xe0 bi\u1ebfn \u0111\u1ed5i (\u0111\u1ecdc code v\xe0 xem l\u1ea1i ph\u1ea7n ",(0,l.kt)("a",{parentName:"li",href:"/docs/front-end/web-admin/import-export-excel#modalexportexcelwithtable"},"ModalExportExcelWithTable"),")")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Clone code ra v\xe0 xu\u1ea5t cho \u0111\u01b0\u1ee3c gi\u1ed1ng h\u1ec7t file c\u0169"),(0,l.kt)("li",{parentName:"ul"},"B\u1eaft \u0111\u1ea7u ch\u1ec9nh s\u1eed header gi\u1ed1ng file m\u1edbi"),(0,l.kt)("li",{parentName:"ul"},"\u0110\u1ed5i api url"),(0,l.kt)("li",{parentName:"ul"},"X\u1eed l\xed l\u1ea1i data (processItem)")),(0,l.kt)("ol",{start:6},(0,l.kt)("li",{parentName:"ol"},"\u0110\u1eb7t l\u1ea1i t\xean file"),(0,l.kt)("li",{parentName:"ol"},"\u0110\u1eb7t l\u1ea1i file key, version (tham kh\u1ea3o ",(0,l.kt)("inlineCode",{parentName:"li"},"app/components/ui/ExcelCheckVersion"),")")),(0,l.kt)("h2",{id:"import"},"Import"),(0,l.kt)("p",null,"Hi\u1ec3u m\u1ed9t c\xe1ch \u0111\u01a1n gi\u1ea3n qu\xe1 tr\xecnh import s\u1ebd ho\u1ea1t \u0111\u1ed9ng nh\u01b0 sau:"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"1. \u0110\u1ecbnh ngh\u0129 1 file json header")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"M\u1ed7i column trong file excel s\u1ebd c\xf3 1 keyword (field_name)")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image",src:n(7313).Z,width:"2636",height:"548"}),"\n",(0,l.kt)("img",{alt:"image",src:n(245).Z,width:"636",height:"882"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"2. \u0110\u1ecdc file excel")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"D\xf9ng XLSX \u0111\u1ec3 \u0111\u1ecdc ra trang ch\u1ee9a d\u1eef li\u1ec7u v\xe0 trang ch\u1ee9 th\xf4ng tin file d\u01b0\u1edbi d\u1ea1ng json"),(0,l.kt)("li",{parentName:"ul"},"Ki\u1ec3m tra th\xf4ng tin file v\xe0 v\u1ecb tr\xed import file, b\xe1o l\u1ed7i n\u1ebfu kh\xf4ng h\u1ee3p l\u1ec7")),(0,l.kt)("p",null,"Tham kh\u1ea3o h\xe0m ",(0,l.kt)("inlineCode",{parentName:"p"},"ReadExcelFile")," t\u1ea1i file ",(0,l.kt)("inlineCode",{parentName:"p"},"ExcelCheckVersion")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"3. Chu\u1ea9n h\xf3a d\u1eef li\u1ec7u")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Chu\u1ea9n h\xf3a json \u0111\u1ecdc \u0111\u01b0\u1ee3c t\u1eeb file th\xe0nh array data theo file header tr\xean")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"4. B\u1eaft \u0111\u1ea7u post d\u1eef li\xeau")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"T\u1eaft \u0111o\u1ea1n array th\xe0nh t\u1eebng ph\u1ea7n v\xe0 post l\xean server x\u1eed l\xed"),(0,l.kt)("li",{parentName:"ul"},"Nh\u1eadn respone v\xe0 th\u1ec3 hi\u1ec7n ti\u1ebfn \u0111\u1ed9, b\xe1o l\u1ed7i n\u1ebfu c\xf3")))}s.isMDXComponent=!0},7313:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/import_header-584775584bfb0a90d992cb4e73c49efa.png"},245:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/import_header_json-078f7310d479e842fdc7cc0bc5a1901f.png"}}]);